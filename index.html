<meta charset="UTF-8">

<style>
    #preview {
        margin: 5px;
        font-size: 2vh;
        font-family: arial;
        max-width: 300px;
        max-height: 300px;
        min-width: 300px;
        min-height: 300px;
        display: block;
        word-break: break-all;
        -webkit-hyphens: auto;
        -moz-hyphens: auto;
        -ms-hyphens: auto;
        hyphens: auto;

    }

    .preview {
        padding: 15px;
    }
</style>

<script src="https://unpkg.com/jspdf@2.5.2/dist/jspdf.umd.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<body>

    <div id="preview" lang="de">

    </div>

    <input id="name" size="40" placeholder="Vorname Nachname"><br>
    <input id="widmung" maxlength=100 size="100" placeholder="Meine Widmung für jemanden"><br>
    Baumart: <select id="plant">
        <option value="-" selected>-</option>
        <option value="palmus dattelus">Dattelpalme</option>
        <option value="algus flechtelus">Algenflechte</option>
    </select>
    <br><br>
    <input id="button" type="submit" value="abschicken">
</body>

<script>

    const cityName = 'Stadt X - Umweltamt';
    const initiativeName = 'Baumstarke Stadt';

    document.getElementById("preview").innerHTML = 'Anmeldungformular für Baumwidmung<br><br>Vorschau<br><br><div class="preview" style="background-color:#eee; text-align:center">' + cityName + '<br>' + initiativeName + '<br><br>-<br>-<br><br>-<br><br>-<br><br></div>';


    document.getElementById("button").addEventListener("click", generatePDF);
    document.getElementById("name").addEventListener("input", generateText);
    document.getElementById("widmung").addEventListener("input", generateText);
    document.getElementById("plant").addEventListener("change", generateText);

    let textToPrint = '';

    function generateText() {

        let name = document.getElementById("name").value;

        let widmung = document.getElementById("widmung").value;


        let plantNameLat = document.getElementById("plant").value;

        var select = document.getElementById('plant');
        var currentOpt = select.options[select.selectedIndex];

        let plantNameDeu = currentOpt.text;


        textToPrint = 'Anmeldungformular für  Baumwidmung<br><br>Vorschau<br><br><div class="preview" style="background-color:#eee; text-align:center">' + cityName + '<br>' + initiativeName + '<br><br>' + plantNameDeu + '<br>' + plantNameLat + '<br><br><b>' + name + '</b><br><br>' + widmung + '</div>';

        document.getElementById("preview").innerHTML = textToPrint;

    }

    console.log(textToPrint);

    function generatePDF() {

        const { jsPDF } = window.jspdf;
        window.html2canvas = html2canvas;

        const doc = new jsPDF();

        doc.html(document.getElementById("preview"), {
            callback: function (doc) {
                doc.save();
            }
        });


    }
</script>